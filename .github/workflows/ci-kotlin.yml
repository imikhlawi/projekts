# Kotlin/Gradle: SchimmenSpiel, CableCar
# Läuft nur, wenn Dateien unter SchimmenSpiel/ oder CableCar/ geändert wurden.

name: CI Kotlin (Gradle)

on:
  push:
    branches: [main, master]
    paths:
      - 'SchimmenSpiel/**'
      - 'CableCar/**'
      - '.github/workflows/ci-kotlin.yml'
  pull_request:
    branches: [main, master]
    paths:
      - 'SchimmenSpiel/**'
      - 'CableCar/**'
      - '.github/workflows/ci-kotlin.yml'

jobs:
  schimmenspiel:
    name: SchimmenSpiel
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Grant execute permission for gradlew
        run: chmod +x SchimmenSpiel/gradlew

      - name: Build
        run: cd SchimmenSpiel && ./gradlew build --no-daemon

  cablecar:
    name: CableCar
    runs-on: ubuntu-latest
    # CableCar braucht SoPra-Maven (optional): Secret SOPRA_GITLAB_TOKEN in Repo setzen
    env:
      SOPRA_GITLAB_TOKEN: ${{ secrets.SOPRA_GITLAB_TOKEN }}
    steps:
      - uses: actions/checkout@v4

      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Grant execute permission for gradlew
        run: chmod +x CableCar/gradlew

      - name: Build
        run: cd CableCar && ./gradlew build --no-daemon
        # Wenn kein Token gesetzt ist, schlägt der Build ggf. fehl (ntf nicht auflösbar).
        # Dann in GitHub: Settings → Secrets → SOPRA_GITLAB_TOKEN anlegen (oder Job deaktivieren).
